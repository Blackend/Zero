;===============================================================================
; Copyright (C) by vLock.dev
;===============================================================================

;===============================================================================
; 16 bitowy kod głównego programu rozruchowego =================================
;===============================================================================
[BITS 16]

; pozycja kodu w przestrzeni segmentu CS
[ORG 0x1000]

;===============================================================================
zero:
	;-----------------------------------------------------------------------
	; przygotuj mapę pamięci
	;-----------------------------------------------------------------------
	%include	"engine/memory.asm"

	;-----------------------------------------------------------------------
	; włącz tryb graficzny
	;-----------------------------------------------------------------------
	%include	"engine/graphics.asm"

	;-----------------------------------------------------------------------
	; przełącz procesor w tryb 32 bitowy
	;-----------------------------------------------------------------------
	%include	"engine/protected_mode.asm"

	;-----------------------------------------------------------------------
	; przełącz procesor w tryb 64 bitowy
	;-----------------------------------------------------------------------
	%include	"engine/long_mode.asm"

	;-----------------------------------------------------------------------
	; konfiguruj obslugę wyjątków i przerwań sprzętowych
	;-----------------------------------------------------------------------
	%include	"engine/idt.asm"

	;-----------------------------------------------------------------------
	; włącz przerwania sprzętowe na kontrolerze PIC
	;-----------------------------------------------------------------------
	%include	"engine/pic.asm"

	;-----------------------------------------------------------------------
	; wczytaj plik jadra systemu
	;-----------------------------------------------------------------------
	%include	"engine/storage.asm"

	;-----------------------------------------------------------------------
	; wyłącz przerwanie na kontrolerze PIT
	;-----------------------------------------------------------------------
	%include	"engine/pit.asm"

	;-----------------------------------------------------------------------
	; przekaż wszystkie niezbędne informacje do jadra systemu
	;-----------------------------------------------------------------------
	%include	"engine/kernel.asm"

	;-----------------------------------------------------------------------
	; sterownik obsługi dysków IDE
	;-----------------------------------------------------------------------
	%include	"engine/driver/storage/ide.asm"

	;-----------------------------------------------------------------------
	; procedura zaokrąglająca adres do pełnej strony
	;-----------------------------------------------------------------------
	%include	"engine/page.asm"

	;-----------------------------------------------------------------------
	; zmienne programu rozruchowego
	;-----------------------------------------------------------------------
	%include	"engine/data.asm"

;===============================================================================
zero_end:
